import pandas as pd
import re
import unicodedata

# Caminho do arquivo
arquivo = r"C:\Users\081784\.vscode\GP\FBL1N_COMPENSADAS.xlsx"

# Importa o arquivo Excel
df = pd.read_excel(arquivo)

#--------------------------------------------
# DICIONARIO DE-PARA
#--------------------------------------------

# Tipo de Documento
mapa_tipo_doc = {
    'AA': 'AA Lançto.imobilizado',
    'AB': 'AB Documento contábil',
    'AF': 'AF Lnçto.depreciação',
    'AN': 'AN Lançto.líq.imobiliz.',
    'AR': 'AR Residual Adiantament',
    'CA': 'CA Sist.Com.Exterior',
    'CM': 'CM Comissão',
    'CP': 'CP Compensa Comissão',
    'DA': 'DA Documento do cliente',
    'DG': 'DG Nota crédito cliente',
    'DR': 'DR Fatura cliente',
    'DZ': 'DZ Pagamento cliente',
    'ES': 'ES Documento estorno',
    'EU': 'EU Difer.arredond.Euro',
    'EX': 'EX Nº externo',
    'FF': 'FF Folha Fornecedor',
    'FP': 'FP Folha Pagamento',
    'KA': 'KA Documento fornecedor',
    'KG': 'KG Nota crédito fornec.',
    'KN': 'KN Fornecedor líquido',
    'KP': 'KP Atualização de conta',
    'KR': 'KR Fatura fornecedor',
    'KZ': 'KZ Pagamento fornecedor',
    'LD': 'LD Lnçto.depreciação Es',
    'ML': 'ML Liquidação ML',
    'PR': 'PR Alteração de preço',
    'RA': 'RA Nota crédito liq.pos',
    'RE': 'RE Fatura brut.',
    'RN': 'RN Fatura líq.',
    'RV': 'RV Transf.docs.faturam.',
    'SA': 'SA Doc.conta do Razão',
    'SB': 'SB Lançamento cta.Razão',
    'SK': 'SK Doc.de caixa',
    'SU': 'SU Doc.débito posterior',
    'TA': 'TA Adiant de Viagens',
    'TV': 'TV Gestão de Viagens',
    'UE': 'UE Transferência dados',
    'WA': 'WA Saída merc.depósito',
    'WE': 'WE Entrada de mercador.',
    'WI': 'WI Doc.inventário',
    'WL': 'WL SaídaMerc/fornecimnt',
    'WN': 'WN Entrada mercad.líqu.',
    'YC': 'YC Consumo Fidelidade',
    'YG': 'YG Geração Fidelidade',
    'YR': 'YR Aj. Receita Fidelid.',
    'Z0': 'Z0 Crédito Cliente ZD10',
    'Z1': 'Z1 Crédito Cliente ZDF1',
    'Z2': 'Z2 Crédito Cliente ZDF2',
    'Z3': 'Z3 Crédito Cliente ZDF3',
    'Z4': 'Z4 Crédito Cliente ZDF4',
    'Z5': 'Z5 Crédito Cliente ZDF5',
    'Z6': 'Z6 Crédito Cliente ZDF6',
    'Z7': 'Z7 Crédito Cliente ZDF7',
    'Z8': 'Z8 Crédito Cliente ZDF8',
    'Z9': 'Z9 Crédito Cliente ZDF9',
    'ZA': 'ZA Doc.conta Razão-SINA',
    'ZB': 'ZB Débito Cliente ZFIC',
    'ZC': 'ZC Doc. livro caixa',
    'ZD': 'ZD Fundo Inadimplência',
    'ZE': 'ZE Encerramento Exercíc',
    'ZF': 'ZF Crédito Cliente ZFID',
    'ZG': 'ZG Doc.conta Razão Gesp',
    'ZI': 'ZI Fundo Inc. Integrado',
    'ZJ': 'ZJ Reversão Contabil',
    'ZK': 'ZK Fundo sina 2',
    'ZM': 'ZM Fundo Emp. Integrado',
    'ZP': 'ZP Lançto.de pagamento',
    'ZR': 'ZR Banco reconciliação',
    'ZS': 'ZS Pagto.por cheque',
    'ZV': 'ZV Compensação do pgto.',
}

#Condições de Pagamento

mapa_cond_pgto = {
    '5DUT': '5DUT 5o dia Util - Fornecedor',
    'A000': 'A000 ADIANTAMENTO',
    'BARR': 'BARR VENCIMENTO DIA 07 DO MES SEGUINTE',
    'COMI': 'COMI Comissões',
    'D060': 'D060 PAGTO EM 60 DIAS (DATA NF) DESCONTO 7%',
    'DESC': 'DESC DESCONTO FINANCEIRO - VERIFICAR PEDIDO',
    'DI30': 'DI30 Pagamento 30 dias Emissão - Frete Distribuição',
    'ESP1': 'ESP1 TODO DIA 05 DO MES',
    'ESPC': 'ESPC VENCE TODO DIA 20 DO MES',
    'F000': 'F000 PAGAMENTO A VISTA',
    'F001': 'F001 PAGAMENTO EM 01 DIA (DATA NF)',
    'F002': 'F002 PAGAMENTO EM 02 DIAS (DATA NF)',
    'F003': 'F003 PAGAMENTO EM 03 DIAS (DATA NF)',
    'F004': 'F004 PAGAMENTO EM 04 DIAS (DATA NF)',
    'F005': 'F005 PAGAMENTO EM 05 DIAS (DATA NF)',
    'F006': 'F006 PAGAMENTO EM 06 DIAS (DATA NF)',
    'F007': 'F007 PAGAMENTO EM 07 DIAS (DATA NF)',
    'F008': 'F008 PAGAMENTO EM 08 DIAS (DATA NF)',
    'F009': 'F009 PAGAMENTO EM 09 DIAS (DATA NF)',
    'F010': 'F010 PAGAMENTO EM 10 DIAS (DATA NF)',
    'F011': 'F011 PAGAMENTO EM 11 DIAS (DATA NF)',
    'F012': 'F012 PAGAMENTO EM 12 DIAS (DATA NF)',
    'F013': 'F013 PAGAMENTO EM 13 DIAS (DATA NF)',
    'F014': 'F014 PAGAMENTO EM 14 DIAS (DATA NF)',
    'F015': 'F015 PAGAMENTO EM 15 DIAS (DATA NF)',
    'F016': 'F016 PAGAMENTO EM 16 DIAS (DATA NF)',
    'F017': 'F017 PAGAMENTO EM 17 DIAS (DATA NF)',
    'F018': 'F018 PAGAMENTO EM 18 DIAS (DATA NF)',
    'F019': 'F019 PAGAMENTO EM 19 DIAS (DATA NF)',
    'F020': 'F020 PAGAMENTO EM 20 DIAS (DATA NF)',
    'F021': 'F021 PAGAMENTO EM 21 DIAS (DATA NF)',
    'F022': 'F022 PAGAMENTO EM 22 DIAS (DATA NF)',
    'F023': 'F023 PAGAMENTO EM 23 DIAS (DATA NF)',
    'F024': 'F024 PAGAMENTO EM 24 DIAS (DATA NF)',
    'F025': 'F025 PAGAMENTO EM 25 DIAS (DATA NF)',
    'F026': 'F026 PAGAMENTO EM 26 DIAS (DATA NF)',
    'F027': 'F027 PAGAMENTO EM 27 DIAS (DATA NF)',
    'F028': 'F028 PAGAMENTO EM 28 DIAS (DATA NF)',
    'F029': 'F029 PAGAMENTO EM 29 DIAS (DATA NF)',
    'F030': 'F030 PAGAMENTO EM 30 DIAS (DATA NF)',
    'F031': 'F031 PAGAMENTO EM 31 DIAS (DATA NF)',
    'F032': 'F032 PAGAMENTO EM 32 DIAS (DATA NF)',
    'F033': 'F033 PAGAMENTO EM 33 DIAS (DATA NF)',
    'F034': 'F034 PAGAMENTO EM 34 DIAS (DATA NF)',
    'F035': 'F035 PAGAMENTO EM 35 DIAS (DATA NF)',
    'F036': 'F036 PAGAMENTO EM 36 DIAS (DATA NF)',
    'F037': 'F037 PAGAMENTO EM 37 DIAS (DATA NF)',
    'F038': 'F038 PAGAMENTO EM 38 DIAS (DATA NF)',
    'F039': 'F039 PAGAMENTO EM 39 DIAS (DATA NF)',
    'F03F': 'F03F PAGAMENTO NO DIA 03 (DIA DO MES)',
    'F040': 'F040 PAGAMENTO EM 40 DIAS (DATA NF)',
    'F041': 'F041 PAGAMENTO EM 41 DIAS (DATA NF)',
    'F042': 'F042 PAGAMENTO EM 42 DIAS (DATA NF)',
    'F043': 'F043 PAGAMENTO EM 43 DIAS (DATA NF)',
    'F044': 'F044 PAGAMENTO EM 44 DIAS (DATA NF)',
    'F045': 'F045 PAGAMENTO EM 45 DIAS (DATA NF)',
    'F046': 'F046 PAGAMENTO EM 46 DIAS (DATA NF)',
    'F047': 'F047 PAGAMENTO EM 47 DIAS (DATA NF)',
    'F048': 'F048 PAGAMENTO EM 48 DIAS (DATA NF)',
    'F049': 'F049 PAGAMENTO EM 49 DIAS (DATA NF)',
    'F050': 'F050 PAGAMENTO EM 50 DIAS (DATA NF)',
    'F051': 'F051 PAGAMENTO EM 51 DIAS (DATA NF)',
    'F052': 'F052 PAGAMENTO EM 52 DIAS (DATA NF)',
    'F053': 'F053 PAGAMENTO EM 53 DIAS (DATA NF)',
    'F054': 'F054 PAGAMENTO EM 54 DIAS (DATA NF)',
    'F055': 'F055 PAGAMENTO EM 55 DIAS (DATA NF)',
    'F056': 'F056 PAGAMENTO EM 56 DIAS (DATA NF)',
    'F057': 'F057 PAGAMENTO EM 57 DIAS (DATA NF)',
    'F058': 'F058 PAGAMENTO EM 58 DIAS (DATA NF)',
    'F059': 'F059 PAGAMENTO EM 59 DIAS (DATA NF)',
    'F05F': 'F05F PAGAMENTO NO DIA 05 (DIA DO MES)',
    'F060': 'F060 PAGAMENTO EM 60 DIAS (DATA NF)',
    'F061': 'F061 PAGAMENTO EM 61 DIAS (DATA NF)',
    'F062': 'F062 PAGAMENTO EM 62 DIAS (DATA NF)',
    'F063': 'F063 PAGAMENTO EM 63 DIAS (DATA NF)',
    'F064': 'F064 PAGAMENTO EM 64 DIAS (DATA NF)',
    'F065': 'F065 PAGAMENTO EM 65 DIAS (DATA NF)',
    'F066': 'F066 PAGAMENTO EM 66 DIAS (DATA NF)',
    'F067': 'F067 PAGAMENTO EM 67 DIAS (DATA NF)',
    'F068': 'F068 PAGAMENTO EM 68 DIAS (DATA NF)',
    'F069': 'F069 PAGAMENTO EM 69 DIAS (DATA NF)',
    'F070': 'F070 PAGAMENTO EM 70 DIAS (DATA NF)',
    'F071': 'F071 PAGAMENTO EM 71 DIAS (DATA NF)',
    'F072': 'F072 PAGAMENTO EM 72 DIAS (DATA NF)',
    'F073': 'F073 PAGAMENTO EM 73 DIAS (DATA NF)',
    'F074': 'F074 PAGAMENTO EM 74 DIAS (DATA NF)',
    'F075': 'F075 PAGAMENTO EM 75 DIAS (DATA NF)',
    'F076': 'F076 PAGAMENTO EM 76 DIAS (DATA NF)',
    'F077': 'F077 PAGAMENTO EM 77 DIAS (DATA NF)',
    'F078': 'F078 PAGAMENTO EM 78 DIAS (DATA NF)',
    'F079': 'F079 PAGAMENTO EM 79 DIAS (DATA NF)',
    'F080': 'F080 PAGAMENTO EM 80 DIAS (DATA NF)',
    'F081': 'F081 PAGAMENTO EM 81 DIAS (DATA NF)',
    'F082': 'F082 PAGAMENTO EM 82 DIAS (DATA NF)',
    'F083': 'F083 PAGAMENTO EM 83 DIAS (DATA NF)',
    'F084': 'F084 PAGAMENTO EM 84 DIAS (DATA NF)',
    'F085': 'F085 PAGAMENTO EM 85 DIAS (DATA NF)',
    'F086': 'F086 PAGAMENTO EM 86 DIAS (DATA NF)',
    'F087': 'F087 PAGAMENTO EM 87 DIAS (DATA NF)',
    'F088': 'F088 PAGAMENTO EM 88 DIAS (DATA NF)',
    'F089': 'F089 PAGAMENTO EM 89 DIAS (DATA NF)',
    'F090': 'F090 PAGAMENTO EM 90 DIAS (DATA NF)',
    'F091': 'F091 PAGAMENTO EM 91 DIAS (DATA NF)',
    'F092': 'F092 PAGAMENTO EM 92 DIAS (DATA NF)',
    'F093': 'F093 PAGAMENTO EM 93 DIAS (DATA NF)',
    'F094': 'F094 PAGAMENTO EM 94 DIAS (DATA NF)',
    'F095': 'F095 PAGAMENTO EM 95 DIAS (DATA NF)',
    'F096': 'F096 PAGAMENTO EM 96 DIAS (DATA NF)',
    'F097': 'F097 PAGAMENTO EM 97 DIAS (DATA NF)',
    'F098': 'F098 PAGAMENTO EM 98 DIAS (DATA NF)',
    'F099': 'F099 PAGAMENTO EM 99 DIAS (DATA NF)',
    'F100': 'F100 PAGAMENTO EM 100 DIAS (DATA NF)',
    'F103': 'F103 PAGAMENTO EM 105 DIAS (DATA NF)',
    'F105': 'F105 PAGAMENTO EM 105 DIAS (DATA NF)',
    'F107': 'F107 PAGAMENTO EM 107 DIAS (DATA NF)',
    'F108': 'F108 PAGAMENTO EM 108 DIAS (DATA NF)',
    'F110': 'F110 PAGAMENTO EM 110 DIAS (DATA NF)',
    'F112': 'F112 PAGAMENTO EM 112 DIAS (DATA NF)',
    'F117': 'F117 PAGAMENTO EM 117 DIAS (DATA NF)',
    'F118': 'F118 PAGAMENTO EM 118 DIAS (DATA NF)',
    'F119': 'F119 PAGAMENTO EM 119 DIAS (DATA NF)',
    'F11F': 'F11F PAGAMENTO NO DIA 11 MES SEGUINTE',
    'F120': 'F120 PAGAMENTO EM 120 DIAS (DATA NF)',
    'F121': 'F121 PAGAMENTO EM 121 DIAS (DATA NF)',
    'F122': 'F122 PAGAMENTO EM 122 DIAS (DATA NF)',
    'F123': 'F123 PAGAMENTO EM 123 DIAS (DATA NF)',
    'F124': 'F124 PAGAMENTO EM 124 DIAS (DATA NF)',
    'F125': 'F125 PAGAMENTO EM 125 DIAS (DATA NF)',
    'F126': 'F126 PAGAMENTO EM 126 DIAS (DATA NF)',
    'F127': 'F127 PAGAMENTO EM 127 DIAS (DATA NF)',
    'F128': 'F128 PAGAMENTO EM 128 DIAS (DATA NF)',
    'F129': 'F129 PAGAMENTO EM 129 DIAS (DATA NF)',
    'F130': 'F130 PAGAMENTO EM 130 DIAS (DATA NF)',
    'F134': 'F134 PAGAMENTO EM 134 DIAS (DATA NF)',
    'F135': 'F135 PAGAMENTO EM 135 DIAS (DATA NF)',
    'F139': 'F139 PAGAMENTO EM 139 DIAS (DATA NF)',
    'F140': 'F140 PAGAMENTO EM 140 DIAS (DATA NF)',
    'F144': 'F144 PAGAMENTO EM 144 DIAS (DATA NF)',
    'F145': 'F145 PAGAMENTO EM 145 DIAS (DATA NF)',
    'F150': 'F150 PAGAMENTO EM 150 DIAS (DATA NF)',
    'F152': 'F152 PAGAMENTO EM 152 DIAS (DATA NF)',
    'F156': 'F156 PAGAMENTO EM 156 DIAS (DATA NF)',
    'F160': 'F160 PAGAMENTO EM 160 DIAS (DATA NF)',
    'F169': 'F169 PAGAMENTO EM 169 DIAS (DATA NF)',
    'F176': 'F176 PAGAMENTO EM 176 DIAS (DATA NF)',
    'F180': 'F180 PAGAMENTO EM 180 DIAS (DATA NF)',
    'F183': 'F183 PAGAMENTO EM 183 DIAS (DATA NF)',
    'F194': 'F194 PAGAMENTO EM 194 DIAS (DATA NF)',
    'F200': 'F200 PAGAMENTO EM 200 DIAS (DATA NF)',
    'F206': 'F206 PAGAMENTO EM 206 DIAS (DATA NF)',
    'F20F': 'F20F PAGAMENTO NO DIA 20 (DIA DO MES)',
    'F210': 'F210 PAGAMENTO EM 210 DIAS (DATA NF)',
    'F21F': 'F21F PAGAMENTO NO DIA 21 (DIA DO MES)',
    'F225': 'F225 PAGAMENTO EM 225 DIAS (DATA NF)',
    'F235': 'F235 PAGAMENTO EM 235 DIAS (DATA NF)',
    'F237': 'F237 PAGAMENTO EM 237 DIAS (DATA NF)',
    'F240': 'F240 PAGAMENTO EM 240 DIAS (DATA NF)',
    'F250': 'F250 PAGAMENTO EM 250 DIAS (DATA NF)',
    'F261': 'F261 PAGAMENTO EM 261 DIAS (DATA NF)',
    'F267': 'F267 PAGAMENTO EM 267 DIAS (DATA NF)',
    'F270': 'F270 PAGAMENTO EM 270 DIAS (DATA NF)',
    'F292': 'F292 PAGAMENTO EM 292 DIAS (DATA NF)',
    'F298': 'F298 PAGAMENTO EM 298 DIAS (DATA NF)',
    'F300': 'F300 PAGAMENTO EM 300 DIAS (DATA NF)',
    'F31F': 'F31F PAGAMENTO NO DIA 31 (DIA DO MES)',
    'F320': 'F320 PAGAMENTO EM 320 DIAS (DATA NF)',
    'F329': 'F329 PAGAMENTO EM 329 DIAS (DATA NF)',
    'F32F': 'F32F PAGTO DIA 16 (DATA NF 1 a 5)',
    'F330': 'F330 PAGAMENTO EM 330 DIAS (DATA NF)',
    'F359': 'F359 PAGAMENTO EM 359 DIAS (DATA NF)',
    'F360': 'F360 PAGAMENTO EM 360 DIAS (DATA NF)',
    'F441': 'F441 PAGAMENTO EM 441 DIAS (DATA NF)',
    'F775': 'F775 PAGAMENTO EM 775 DIAS (DATA NF)',
    'F96F': 'F96F Vencto toda Terça Feira obedecendo 15 dias',
    'F97F': 'F97F Vencto toda Terça Feira obedecendo 7 dias',
    'F98F': 'F98F PAGTO DIA 22 (DATA NF ATÉ DIA 05)',
    'F99F': 'F99F PAGTO DIA 20 (NF DATA ENTRADA ATÉ DIA 15)',
    'F99U': 'F99U PGTO DIA 10 (NF DATA ENTRADA ATÉ DIA 31)',
    'FIXO': 'FIXO PAGAMENTO COM DIA, MES, ANO FIXOS',
    'FM14': 'FM14 14 DO MÊS DA EMISSÃO DA NF',
    'FM20': 'FM20 20 DO MÊS DA EMISSÃO DA NF',
    'FM25': 'FM25 25 DO MÊS DA EMISSÃO DA NF',
    'FM26': 'FM26 26 DO MÊS DA EMISSÃO DA NF',
    'FM27': 'FM27 27 MÊS DA EMISSÃO DA NF',
    'FM28': 'FM28 28 DO MÊS DA EMISSÃO DA NF',
    'FM30': 'FM30 DIA 30 DO MÊS DA EMISSÃO DA NF',
    'FP06': 'FP06 DIA 06 DO PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FP14': 'FP14 DIA 14 DO PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FP15': 'FP15 DIA 15 DO PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FP17': 'FP17 DIA 17 DO PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FP26': 'FP26 DIA 26 DO PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FP27': 'FP27 27 PRÓXIMO MÊS DA EMISSÃO DA NF',
    'FPRG': 'FPRG PAGAMENTO PROGRAMADO',
    'LT45': 'LT45 Vencto 45 dias fora a semana TIAL',
    'M001': 'M001 PAGTO EM 01 DIA (DATA LANCAMENTO)',
    'M002': 'M002 PAGTO EM 02 DIAS (DATA LANCAMENTO)',
    'M003': 'M003 PAGTO EM 03 DIAS (DATA LANCAMENTO)',
    'M004': 'M004 PAGTO EM 04 DIAS (DATA LANCAMENTO)',
    'M005': 'M005 PAGTO EM 05 DIAS (DATA LANCAMENTO)',
    'M006': 'M006 PAGTO EM 06 DIAS (DATA LANCAMENTO)',
    'M007': 'M007 PAGTO EM 07 DIAS (DATA LANCAMENTO)',
    'M008': 'M008 PAGTO EM 08 DIAS (DATA LANCAMENTO)',
    'M009': 'M009 PAGTO EM 09 DIAS (DATA LANCAMENTO)',
    'M010': 'M010 PAGTO EM 10 DIAS (DATA LANCAMENTO)',
    'M011': 'M011 PAGTO EM 11 DIAS (DATA LANCAMENTO)',
    'M012': 'M012 PAGTO EM 12 DIAS (DATA LANCAMENTO)',
    'M013': 'M013 PAGTO EM 13 DIAS (DATA LANCAMENTO)',
    'M014': 'M014 PAGTO EM 14 DIAS (DATA LANCAMENTO)',
    'M015': 'M015 PAGTO EM 15 DIAS (DATA LANCAMENTO)',
    'M016': 'M016 PAGTO EM 16 DIAS (DATA LANCAMENTO)',
    'M017': 'M017 PAGTO EM 17 DIAS (DATA LANCAMENTO)',
    'M018': 'M018 PAGTO EM 18 DIAS (DATA LANCAMENTO)',
    'M019': 'M019 PAGTO EM 19 DIAS (DATA LANCAMENTO)',
    'M01M': 'M01M PAGTO DIA 01 (DATA FIXA DO MÊS)',
    'M020': 'M020 PAGTO EM 20 DIAS (DATA LANCAMENTO)',
    'M021': 'M021 PAGTO EM 21 DIAS (DATA LANCAMENTO)',
    'M022': 'M022 PAGTO EM 22 DIAS (DATA LANCAMENTO)',
    'M023': 'M023 PAGTO EM 23 DIAS (DATA LANCAMENTO)',
    'M024': 'M024 PAGTO EM 24 DIAS (DATA LANCAMENTO)',
    'M025': 'M025 PAGTO EM 25 DIAS (DATA LANCAMENTO)',
    'M026': 'M026 PAGTO EM 26 DIAS (DATA LANCAMENTO)',
    'M027': 'M027 PAGTO EM 27 DIAS (DATA LANCAMENTO)',
    'M028': 'M028 PAGTO EM 28 DIAS (DATA LANCAMENTO)',
    'M029': 'M029 PAGTO EM 29 DIAS (DATA LANCAMENTO)',
    'M02M': 'M02M PAGTO DIA 02 (DATA FIXA DO MÊS)',
    'M030': 'M030 PAGTO EM 30 DIAS (DATA LANCAMENTO)',
    'M032': 'M032 PAGTO EM 32 DIAS (DATA LANCAMENTO)',
    'M03M': 'M03M PAGTO DIA 03(DATA FIXA DO MÊS)',
    'M040': 'M040 PAGTO EM 40 DIAS (DATA LANCAMENTO)',
    'M041': 'M041 PAGTO EM 41 DIAS (DATA LANCAMENTO)',
    'M042': 'M042 PAGTO EM 42 DIAS (DATA LANCAMENTO)',
    'M04M': 'M04M PAGTO DIA 04(DATA FIXA DO MÊS)',
    'M05M': 'M05M PAGTO DIA 05(DATA FIXA DO MÊS)',
    'M06M': 'M06M PAGTO DIA 06(DATA FIXA DO MÊS)',
    'M07M': 'M07M PAGTO DIA 07(DATA FIXA DO MÊS)',
    'M08M': 'M08M PAGTO DIA 08(DATA FIXA DO MÊS)',
    'M09M': 'M09M PAGTO DIA 09(DATA FIXA DO MÊS)',
    'M10M': 'M10M PAGTO DIA 10(DATA FIXA DO MÊS)',
    'M11M': 'M11M PAGTO DIA 11(DATA FIXA DO MÊS)',
    'M12M': 'M12M PAGTO DIA 12(DATA FIXA DO MÊS)',
    'M13M': 'M13M PAGTO DIA 13(DATA FIXA DO MÊS)',
    'M14M': 'M14M PAGTO DIA 14(DATA FIXA DO MÊS)',
    'M15M': 'M15M PAGTO DIA 15(DATA FIXA DO MÊS)',
    'M16M': 'M16M PAGTO DIA 16(DATA FIXA DO MÊS)',
    'M17M': 'M17M PAGTO DIA 17(DATA FIXA DO MÊS)',
    'M18M': 'M18M PAGTO DIA 18(DATA FIXA DO MÊS)',
    'M19M': 'M19M PAGTO DIA 19(DATA FIXA DO MÊS)',
    'M20M': 'M20M PAGTO DIA 20(DATA FIXA DO MÊS)',
    'M21M': 'M21M PAGTO DIA 21(DATA FIXA DO MÊS)',
    'M22M': 'M22M PAGTO DIA 22(DATA FIXA DO MÊS)',
    'M23M': 'M23M PAGTO DIA 23(DATA FIXA DO MÊS)',
    'M24M': 'M24M PAGTO DIA 24(DATA FIXA DO MÊS)',
    'M25M': 'M25M PAGTO DIA 25(DATA FIXA DO MÊS)',
    'M26M': 'M26M PAGTO DIA 26(DATA FIXA DO MÊS)',
    'M27M': 'M27M PAGTO DIA 27(DATA FIXA DO MÊS)',
    'M28M': 'M28M PAGTO DIA 28(DATA FIXA DO MÊS)',
    'M29M': 'M29M PAGTO DIA 29(DATA FIXA DO MÊS)',
    'M30M': 'M30M PAGTO DIA 30(DATA FIXA DO MÊS)',
    'M31M': 'M31M PAGTO DIA 31(DATA FIXA DO MÊS)',
    'PARC': 'PARC PAGAMENTO PARCELADO A DEFINIR',
    'PF01': 'PF01 21/35 DIAS',
    'PF02': 'PF02 25/30 DIAS',
    'PF03': 'PF03 28/35 DIAS',
    'PF04': 'PF04 28/56 DIAS',
    'PF05': 'PF05 28/40 DIAS',
    'PF06': 'PF06 28/42 DIAS',
    'PF07': 'PF07 28/60 DIAS',
    'PF08': 'PF08 25/35 DIAS',
    'PF09': 'PF09 25/40 DIAS',
    'PF10': 'PF10 30/40 DIAS',
    'PF11': 'PF11 30/45 DIAS',
    'PF12': 'PF12 30/35 DIAS',
    'PF13': 'PF13 30/60 DIAS',
    'PF14': 'PF14 35/42 DIAS',
    'PF15': 'PF15 45/60 DIAS',
    'PF16': 'PF16 45/90 DIAS',
    'PF17': 'PF17 60/75 DIAS',
    'PF18': 'PF18 20/30/40 DIAS',
    'PF19': 'PF19 21/28/35 DIAS',
    'PF20': 'PF20 25/30/35 DIAS',
    'PF21': 'PF21 28/35/42 DIAS',
    'PF22': 'PF22 30/60/90 DIAS',
    'PF23': 'PF23 30/45/60 DIAS',
    'PF24': 'PF24 60/90 DIAS',
    'PF25': 'PF25 35/42/52 DIAS',
    'PF26': 'PF26 35/45/55 DIAS',
    'PF27': 'PF27 42/49/56 DIAS',
    'PF28': 'PF28 45/60/75 DIAS',
    'PF29': 'PF29 49/72/95 DIAS',
    'PF30': 'PF30 20/30/40/50 DIAS',
    'PF31': 'PF31 28/35/42/49 DIAS',
    'PF32': 'PF32 30/60/90/120 DIAS',
    'PF33': 'PF33 90/120/150/180 DIAS',
    'PF34': 'PF34 45/55/65/75/85 DIAS',
    'PF35': 'PF35 28/35/42/49/56 DIAS',
    'PF36': 'PF36 10/30 DIAS',
    'PF37': 'PF37 28/45 DIAS',
    'PF38': 'PF38 50% À VISTA / 50% TÉRMINO OBRA',
    'PF39': 'PF39 50% À VISTA / 50% 30 DIAS',
    'PF40': 'PF40 À VISTA/30/60 DIAS',
    'PF41': 'PF41 À VISTA/10/20 DIAS',
    'PF42': 'PF42 15/30/45/60 DIAS',
    'PF43': 'PF43 28/35 DIAS',
    'PF44': 'PF44 60% ADIANT / 20% 30 DIAS/ 20% 60 DIAS(TÉRMINO)',
    'PF45': 'PF45 32%-12/12%-42/12%-73/16%-99/16%-160/12%-176 DD',
    'PF46': 'PF46 15/30 DIAS',
    'PF47': 'PF47 53,435%-39/46,565%-70/ DD',
    'PF48': 'PF48 46/77 DIAS',
    'PF49': 'PF49 4/11/25 DIAS',
    'PF50': 'PF50 6/30/60/91/122/152/183/194 DIAS',
    'PF51': 'PF51 13/30/90 DIAS',
    'PF52': 'PF52 20/50/80 DIAS',
    'PF53': 'PF53 35/42/49 DIAS',
    'PF54': 'PF54 7/14/29/40 DIAS',
    'PF55': 'PF55 28/59 DIAS',
    'PF56': 'PF56 5/30/60/90/120 DIAS',
    'PF57': 'PF57 38/69 DIAS',
    'PF58': 'PF58 32/63 DIAS',
    'PF59': 'PF59 30/60/65 DIAS',
    'PF60': 'PF60 15/29/36 DIAS',
    'PF61': 'PF61 34%15DIAS/ 66%45 DIAS',
    'PF62': 'PF62 50% A VISTA/25% 21 DIAS/25% 35 DIAS',
    'PF63': 'PF63 25% 18 / 25% 28 / 25% 61 / 25% 91 DIAS',
    'PF64': 'PF64 33,333% 105 / 33,333% 120/ 33,334% 135 DIAS',
    'PF65': 'PF65 33,333% 15 / 33,333% 30/ 33,334% 45 DIAS',
    'PF66': 'PF66 60/80/100 DIAS',
    'PF67': 'PF67 15 / 45 / 75 DIAS',
    'PF68': 'PF68 21 / 42 DIAS',
    'PF69': 'PF69 30 / 60 / 90 / 120 / 150 DIAS',
    'PF70': 'PF70 90 / 120 / 150 / 180 / 210 / 240 DIAS',
    'PF71': 'PF71 86/117/145/176/206/237/267/298/329/359 DIAS',
    'PF72': 'PF72 60 / 90 / 120 / 150 / 180 / 210 DIAS',
    'PF73': 'PF73 31 / 59 DIAS',
    'PF74': 'PF74 20 / 40 / 60 DIAS',
    'PF75': 'PF75 28/56/84 DIAS',
    'PF76': 'PF76 15/30/50 DIAS',
    'PF77': 'PF77 40/70 DIAS',
    'PF78': 'PF78 20/50/80/110 DIAS',
    'PF79': 'PF79 20% 15 DIAS // RESTANTE EM 30/60 DIAS',
    'PF80': 'PF80 11/41 DIAS',
    'PF81': 'PF81 30/40/50 DIAS',
    'PF82': 'PF82 20/40 DIAS',
    'PF83': 'PF83 À VISTA / 10 DIAS',
    'PF84': 'PF84 66,67% EM 7 DIAS / 33,33% EM 35 DIAS',
    'PF85': 'PF85 30/60/90/120/150/180/210/240/270/300 DIAS',
    'PF86': 'PF86 30/60/90/120/150/180 DIAS',
    'PF87': 'PF87 15/30/60 DIAS',
    'PF88': 'PF88 35/50 DIAS',
    'PF89': 'PF89 23/53 DIAS',
    'PF90': 'PF90 42/45/60 DIAS',
    'PF91': 'PF91 30/60/75 DIAS',
    'PF92': 'PF92 20/40/60 DIAS',
    'PF93': 'PF93 24/54 DIAS',
    'PF94': 'PF94 15/30/60/90 DIAS',
    'PF95': 'PF95 30% À VISTA / 70% EM 28 DIAS',
    'PF96': 'PF96 28/42/56 DIAS',
    'PF97': 'PF97 21/30/60/90 DIAS',
    'PF98': 'PF98 30/45/60/75 DIAS',
    'PF99': 'PF99 30/60/90/120/150 DIAS',
    'PFA1': 'PFA1 50dias 60dias 70dias',
    'PFA2': 'PFA2 77/108/134/144/169/200/225/235/261/292/320 DIAS',
    'PFA3': 'PFA3 75/90/120 DIAS',
    'PFAA': 'PFAA 21 Dias - 30% 40 Dias - 70%',
    'PFAB': 'PFAB 60/90/120 DIAS',
    'PFAC': 'PFAC 90 Dias - 50% 120 Dias - 50%',
    'PFAD': 'PFAD 15 / 48 / 77 / 107 /139 DATA NF',
    'PFAE': 'PFAE 25/53/81 DIAS Data NF',
    'PFAG': 'PFAG 15/30/60/90/120 DIAS Data NF',
    'PG01': 'PG01 28/56/85 DIAS',
    'PG02': 'PG02 23/30/37 DIAS',
    'PG03': 'PG03 45/52 DIAS',
    'PG04': 'PG04 40/50/60 DIAS',
    'PG05': 'PG05 42/50/60 DIAS',
    'PG06': 'PG06 28/56/84/112 DIAS',
    'PG07': 'PG07 31/61DIAS',
    'PG08': 'PG08 42/57/72DIAS',
    'PG09': 'PG09 28/60/90/120/150DIAS',
    'PG10': 'PG10 64/95/125/156',
    'PG11': 'PG11 70/98 DIAS',
    'PG12': 'PG12 21/42/63/84 DIAS',
    'PG13': 'PG13 28/56/84/112 DIAS',
    'PG14': 'PG14 29/59 DIAS',
    'PG15': 'PG15 21/28/35/42',
    'PG16': 'PG16 14/21/28',
    'PG17': 'PG17 40/50/60',
    'PG18': 'PG18 30/60/90/120/150/180/210/240/270/300/330/360 DIAS',
    'PG19': 'PG19 20/40/60/80',
    'PG20': 'PG20 21 40% / 42 30% / 56 30%',
    'PG21': 'PG21 25/40/60/75',
    'PG22': 'PG22 70/80/90',
    'PG23': 'PG23 30/60/90/120/150/180/210/240',
    'PG24': 'PG24 Parcelado 14 e 21 Dias - Compras',
    'PG25': 'PG25 50% ADIANTAMENTO / 50% 30 DIAS',
    'PG26': 'PG26 ADIANTAMENTO/30/60/90/120',
    'PG27': 'PG27 ADIANTAMENTO/25/50/75/100',
    'PG28': 'PG28 15/30/60/90/120/150 DIAS',
    'PG29': 'PG29 33 % ADIANTAMENTO/ 33% 30  DIAS / 34% 60 DIAS',
    'PG30': 'PG30 70% A VISTA 30% 30 DIAS',
    'PG31': 'PG31 30/180 DIAS',
    'PG32': 'PG32 30/90 DIAS',
    'PG33': 'PG33 21/28 DIAS',
    'PG34': 'PG34 14/21 DIAS',
    'PG35': 'PG35 30% ADIANTAMENTO/ 23% 30D / 23% 60D / 24% 90D',
    'PG36': 'PG36 40% ADIANTAMENTO/ 30% 30  DIAS / 30% 60 DIAS',
    'PG37': 'PG37 50% ADIANTAMENTO/ 30/60/90/120/150 DIAS',
    'PG38': 'PG38 30% ANTECIAPADO / RESTANTE EM 75 DIAS',
    'PG39': 'PG39 90% ANTECIAPADO / RESTANTE EM 30 DIAS',
    'PG40': 'PG40 14/28 DIAS',
    'PG41': 'PG41 50% ADIANTAMENTO / 50% 40 DIAS',
    'PG42': 'PG42 20% ADIANTAMENTO/RESTANTE DIVID. EM 35/42/52 DIAS',
    'PG43': 'PG43 50% ADIANTAMENTO - RESTANTE 20/40/60 DIAS',
    'PG44': 'PG44 50% ADIANTAMENTO - RESTANTE 30/60 DIAS',
    'PG45': 'PG45 30% ADIANTAMENTO / 70% 30 DIAS - DATA EMISSÃO',
    'PG46': 'PG46 28/43/58/73/88/103/118 DIAS-DATA EMISSAO',
    'PG47': 'PG47 25% ADIANTAMENTO / 30/60/90 DIAS',
    'PG48': 'PG48 50% ADIANTAMENTO / 50% À VISTA',
    'PG49': 'PG49 40% ADIANTAMENTO / 30/60/90 DIAS',
    'PG50': 'PG50 30% ADIANTAMENTO / 70% 120 DIAS - DATA EMISSÃO',
    'R000': 'R000 PAGAMENTO A VISTA REPRESENTANTE',
    'R002': 'R002 PAGAMENTO EM 02 DIAS (DATA NF) FUNCIONARIO',
    'R014': 'R014 PAGAMENTO EM 14 DIAS (DATA NF)',
    'TA14': 'TA14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TA21': 'TA21 Frete Animais - 21 Dias - Terça-Feira',
    'TC21': 'TC21 Frete Concentrador - 21 Dias - Terça-Feira',
    'TD14': 'TD14 Frete Distribuição - 14 Dias - Terça-Feira',
    'TD21': 'TD21 Frete Distribuição - 21 Dias - Terça-Feira',
    'TD30': 'TD30 Frete Distribuição - 30 Dias - Terça-Feira',
    'TD40': 'TD40 Frete Distribuição - 40 Dias - Terça-Feira',
    'TG14': 'TG14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TG21': 'TG21 Frete Graos - 21 Dias - Terça-Feira',
    'TO14': 'TO14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TO21': 'TO21 Frete Outros - 21 Dias - Terça-Feira',
    'TP14': 'TP14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TP21': 'TP21 Frete Pessoas - 21 Dias - Terça-Feira',
    'TR14': 'TR14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TR21': 'TR21 Frete Ração - 21 Dias - Terça-Feira',
    'TT14': 'TT14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TT21': 'TT21 Frete Transferencia - 21 Dias - Terça-Feira',
    'TT30': 'TT30 Frete Transferencia - 30 Dias - Terça-Feira',
    'TZ14': 'TZ14 Frete Distribuição - 21 Dias - Terça-Feira',
    'TZ21': 'TZ21 Frete Fornecedores 21 dias -Terça-feira',
}

#Forma de pagamento

mapa_frm_pgto = {
    '1': '1	 Folha Pagamento',
    'A': 'A	 Duplicata',
    'B': 'B	 Pagamento Manual',
    'C': 'C	 Cheques',
    'D': 'D	 Boleto',
    'E': 'E	 Cheque/Dinheiro',
    'F': 'F	 CLIENTES - PAGTO CARTAO',
    'G': 'G	 CLIENTES - PAGTO . DOC',
    'H': 'H	 CLIENTE EXPORTAÇÃO',
    'I': 'I	 CLIENTES - PAG. BOLETO À VISTA',
    'J': 'J	 PEC FLASH',
    'K': 'K	 BOLETO FLASH',
    'L': 'L	 CLIENTES - COBRANÇA ESPECIAL',
    'M': 'M	 MARKETPLACES',
    'N': 'N	 Pagamento Tributos',
    'O': 'O	 Ordem de Pagamento',
    'P': 'P	 Folha Pagamento Pif Paf',
    'Q': 'Q	 Desconto em folha',
    'R': 'R	 DINHEIRO',
    'S': 'S	 Pgto Conta Poupança',
    'T': 'T	 Transferencia s/ SPB',
    'U': 'U	 Transferencia Conta Corrente',
    'V': 'V	 RECEBIMENTO PIX',
    'W': 'W	 CLIENTES - CHEQUES DEVOLVIDOS',
    'X': 'X	 Pagamento Boleto Bancário',
    'Y': 'Y	 PAGAMENTO DEPÓSITO ',
    'Z': 'Z	 Pagamento por PIX',
}

#Bloqueio de Pagamento

mapa_bloq_pgto = {
    '':  ' Autorizado p/pgto.',
    '*': '*	 Ignorar conta',
    '0': '0	 Criar lote de pgto',
    '1': '1	 Lote de pgto criado',
    '2': '2	 Autorizado p/ pgto',
    'A': 'A	 Bloqueado p/pgto.',
    'B': 'B	 Ausência de boleto',
    'C': 'C	 Cartao Credito',
    'D': 'D	 Ausência dados banco',
    'F': 'F	 Pgto Fora Prazo',
    'G': 'G	 Adiantamento Pgto.',
    'H': 'H	 Adiantamento Solict.',
    'J': 'J	 Pagamento Juros',
    'L': 'L	 Adiantamento Aberto',
    'M': 'M	 Montante  Fatura',
    'N': 'N	 Proc.post.entr.pgto.',
    'P': 'P	 Ordem de pagamento',
    'R': 'R	 Revisão de faturas',
    'S': 'S	 Bloq.s/Suprimentos',
    'V': 'V	 Compensação de pgto.',
    'X': 'X	 Documento Vencido',
}

# CRIA AS NOVAS COLUNAS RECLASSIFICADAS

df['Tp_Doc'] = df['Tipo de documento'].map(mapa_tipo_doc)
df['Cond_pgto'] = df['Condições pagamento'].map(mapa_cond_pgto)
df['Frm_Pgto'] = df['FrmPgto'].map(mapa_frm_pgto)
df['Bloq_Pgto'] = df['Bloqueio pgto.'].map(mapa_bloq_pgto)

#Regra de Documento de Compensação

def categorizar_compe(doc):
    if str(doc).startswith('110'):
        return 'Doc Desmembrado'
    elif str(doc).startswith('350'):
        return 'Estorno'
    elif str(doc).startswith('200'):
        return 'Pago'
    else:
        return 'Outros'
    
df['Categ_Comp'] = df['Doc.compensação'].apply(categorizar_compe)

# RESULTADO

print(df[['Tipo de documento', 'Tp_Doc', 
          'Condições pagamento', 'Cond_pgto',
          'FrmPgto', 'Frm_Pgto',
          'Bloqueio pgto.', 'Bloq_Pgto']].head())

# -----------------------------
# ANÁLISE DE DATAS
# -----------------------------

# Garante que as colunas de data sejam do tipo datetime
df['Data do documento'] = pd.to_datetime(df['Data do documento'], errors='coerce')
df['Data de lançamento'] = pd.to_datetime(df['Data de lançamento'], errors='coerce')
df['Vencimento líquido'] = pd.to_datetime(df['Vencimento líquido'], errors='coerce')

# ===== Regra 1: Emit_Lanc =====
df['Emitido_Lancado'] = (df['Data do documento'] - df['Data de lançamento']).dt.days

def classificar_emit_lanc(x):
    if pd.isna(x):
        return 'Data inválida'
    elif x == 0:
        return 'NF Lançada no prazo'
    elif x < 0:
        return 'NF Lançada posterior à emissão'
    else:
        return 'NF Lançada anterior à emissão'

df['Emit_Lanc'] = df['Emitido_Lancado'].apply(classificar_emit_lanc)

# ===== Regra 2: Condi_Pgto =====

# Extrai o número de dias da condição de pagamento (ex: F030 → 30)
df['DiaCondPgto'] = df['Condições pagamento'].astype(str).str.extract(r'(\d+)').astype(float)

# Diferença entre Data do Documento e Vencimento Líquido
df['DifEmiVenc'] = (df['Vencimento líquido'] - df['Data do documento']).dt.days

# Calcula a diferença entre o prazo da condição e o vencimento real
df['DifFinal'] = df['DiaCondPgto'] - df['DifEmiVenc']

def classificar_cond_pgto(x):
    if pd.isna(x):
        return 'Dados insuficientes'
    elif x == 0:
        return 'Pago dentro das condições | vencimento de pagamento'
    elif x > 0:
        return 'Pago antecipado das condições | vencimento de pagamento'
    else:
        return 'Pago fora das condições | vencimento de pagamento'

df['Condi_Pgto'] = df['DifFinal'].apply(classificar_cond_pgto)

#Caminho Output 

arquivo_output = r"C:\Users\081784\.vscode\GP\FBL1N_COMPENSADAS_RECLASSIFICADA.xlsx"

#Exporta o dataframe
df.to_excel(arquivo_output, index=False)

print((f"Arquivo exportado com sucesso para:\n{arquivo_output}"))